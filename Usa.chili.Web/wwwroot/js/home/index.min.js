function populateStationDropdown_Jquery(){axios.get(ajaxUrls.stationList).then(function(n){n.data.forEach(function(n){const t=$("<option>");t.text(n.displayName);t.val(n.id);n.id===1&&t.prop("selected",!0);$("#stationSelection").append(t)});$("#stationSelection").select2(select2Options);$("#stationSelection").on("change",function(){getStationDataAndDraw($(this).val())})}).catch(function(n){console.log("populateStationDropdown failed",n)})}function goToFullData(n,t){url=document.getElementById("widgetFullDataLink").href;t===null&&(t="");var i=new RegExp("\\b("+n+"=).*?(&|#|$)");if(url.search(i)>=0)return url.replace(i,"$1"+t+"$2");url=url.replace(/[?#]$/,"");url=url+(url.indexOf("?")>0?"&":"?")+n+"="+t;document.getElementById("widgetFullDataLink").href=url}function getStationDataAndDraw(n){currentStation=n;axios.get("/data/StationObservation?id="+n).then(function(n){n.data!=null&&drawStation(n.data)}).catch(function(n){console.log("getStationDataAndDraw failed",n)})}function drawStation(n){const at=Math.round(Number(n.airTemperature)),gt=Math.round(Number(n.dewPoint)),ni=Math.round(Number(n.realHumidity)),vt=Math.round(Number(n.windDirection)),ti=Math.round(Number(n.windSpeed)),ii=Number(n.precipitation),oi=Number(n.pressure),ri=n.stationTimestamp,e=$("#stationObservationsCanvas"),t=e.get(0).getContext("2d");e.attr("width",e.width());e.attr("height",e.height());const ui=$("#stationObservationsCanvasDiv");divWidth=ui.width()-10;e.attr("width",divWidth);e.attr("height",divWidth);t.clearRect(0,0,e.width(),e.height());t.closePath();const f=e.height(),l=e.width(),g=f*.2,a=l*.08,y=f*.7,k=l*.13,yt=y+(k-a)*.4,it=-30,pt=120,rt=f*.95,ut=f*.87,wt=l*.15,bt=l*.45,fi=ut,ei=rt,kt=l*.75,ft=(g-y)/(pt-it),dt=y-ft*it,i=l*.65,r=(g+y)/2,o=f*.25,et=5,si=o/et,nt=(f*.06).toFixed(0),tt=(f*.04).toFixed(0),p=(f*.03).toFixed(0),s=(f*.01).toFixed(0),d=(s/4).toFixed(0),ot=((Number(s)+Number(d))/2).toFixed(0);t.beginPath();t.font=nt.toString()+"pt Calibri";t.fillStyle="blue";t.textAlign="center";t.fillText(n.stationName,l*.5,f*.065);t.closePath();t.beginPath();t.font=tt.toString()+"pt Calibri";t.fillStyle="purple";t.textAlign="center";t.fillText("Valid at: "+ri+" CST",l*.5,f*.125);t.closePath();t.beginPath();t.rect(a,g,k-a,y-g);t.lineWidth=d;t.strokeStyle="black";t.stroke();t.closePath();t.beginPath();t.arc((a+k)/2,yt,(yt-y)*2,2*Math.PI,!1);t.fillStyle="red";t.fill();t.lineWidth=d;t.strokeStyle="black";t.stroke();t.closePath();t.beginPath();let v=at*ft+dt;t.rect(a,v,k-a,y-v);t.fillStyle="red";t.fill();t.closePath();t.font=p.toString()+"pt Calibri";t.textAlign="right";t.fillStyle="red";t.fillText(at,a-p/2,v+p/2);v=0;for(let n=it+10;n<=pt;n+=20)t.beginPath(),v=ft*n+dt,t.moveTo(a,v),t.lineTo(k,v),t.lineWidth=d,t.strokeStyle="LightGray",t.stroke(),t.closePath(),t.font=p.toString()+"pt Calibri",t.fillStyle="Gray",t.textAlign="left",t.fillText(n,k+p/2,v+p/2);t.font=tt.toString()+"pt Calibri";t.textAlign="center";t.fillStyle="brown";t.fillText("Rel. Hum.",wt,ut);t.font=nt.toString()+"pt Calibri";t.fillText(ni.toString()+"%",wt,rt);t.font=tt.toString()+"pt Calibri";t.fillStyle="green";t.fillText("Dew Pt.",bt,ut);t.font=nt.toString()+"pt Calibri";t.fillText(gt.toString(),bt,rt);t.font=tt.toString()+"pt Calibri";t.fillStyle="blue";t.fillText("Today's Rain",kt,fi);t.font=nt.toString()+"pt Calibri";t.fillText(ii.toString()+" in.",kt,ei);t.beginPath();t.moveTo(i-o,r);t.lineTo(i+o,r);t.lineWidth=d;t.strokeStyle="gray";t.stroke();t.closePath();t.font=p.toString()+"pt Calibri";t.textAlign="center";t.fillStyle="gray";t.fillText("W",i-o-2*s,r+1.5*s);t.fillText("E",i+o+2*s,r+1.5*s);t.fillText("N",i,r-o-s);t.fillText("S",i,r+o+3*s);t.beginPath();t.moveTo(i,r-o);t.lineTo(i,r+o);t.lineWidth=d;t.strokeStyle="gray";t.stroke();t.closePath();t.beginPath();const h=o*Math.sin(vt*Math.PI/180),c=-1*o*Math.cos(vt*Math.PI/180);t.moveTo(i,r);t.lineTo(i+h,r+c);t.lineWidth=s;t.strokeStyle="black";t.stroke();t.closePath();t.beginPath();t.arc(i,r,f*.02,0,2*Math.PI,!1);t.fillStyle="white";t.fill();t.lineWidth=s;t.strokeStyle="black";t.stroke();t.closePath();let w=Math.round(ti/5);const st=Math.floor(w/10);w=w-10*st;const ht=Math.floor(w/2);w=w-ht*2;let u=1;const b=1/15,ct=-1*c/et,lt=h/et;if(st>0)for(let n=0;n<st;n++)t.fillStyle="black",t.beginPath(),t.moveTo(i+h*u,r+c*u),t.lineTo(i+h*(u-.5*b)+ct,r+c*(u-.5*b)+lt),t.lineTo(i+h*(u-b),r+c*(u-b)),t.lineWidth=ot,t.strokeStyle="black",t.stroke(),t.closePath(),t.fill(),u-=b*2;if(ht>0)for(let n=0;n<ht;n++)t.beginPath(),t.moveTo(i+h*u,r+c*u),t.lineTo(i+h*u+ct,r+c*u+lt),t.lineWidth=ot,t.strokeStyle="black",t.stroke(),t.closePath(),u-=b;w>0&&(t.beginPath(),t.moveTo(i+h*u,r+c*u),t.lineTo(i+h*u+ct*.5,r+c*u+lt*.5),t.lineWidth=ot,t.strokeStyle="black",t.stroke(),t.closePath(),u-=b)}function changeRegional(n){const t=$("#regionalImage");n==1?t.attr("src","http://weather.southalabama.edu/images/surface/GulfCoast_CHILI_Temp.png"):n==2?t.attr("src","http://weather.southalabama.edu/images/surface/GulfCoast_CHILI_Dewpoint.png"):n==3&&t.attr("src","http://weather.southalabama.edu/images/surface/GulfCoast_CHILI_Pressure.png")}const USACampusWestStationId=23;var currentStation="23";$(function(){$("#dataSetSelection").select2(Core.select2Options);$("#dataSetSelection").on("change",function(){changeRegional($(this).val())})});const App=new Vue({el:"#app",data:function(){return{stations:[],model:{stationId:23}}},created:function(){Core.populateStationDropdown(this,!0)},watch:{"model.stationId":function(n){getStationDataAndDraw(n)}}});